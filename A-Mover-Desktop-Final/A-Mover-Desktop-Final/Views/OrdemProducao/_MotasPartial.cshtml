@model A_Mover_Desktop_Final.Models.OrdemProducao

<h3 class="mt-4">üèçÔ∏è Mota Associada √† OP</h3>

<div class="mb-3">
    @if (Model.Estado == EstadoOrdemProducao.EmProducao)
    {
        <a asp-controller="OrdemProducao" asp-action="AdicionarMota" asp-route-id="@Model.IDOrdemProducao" class="btn btn-primary">
            <i class="fas fa-plus-circle me-1"></i> Adicionar Mota
        </a>
    }
</div>

@if (Model.Mota != null)
{
    <div class="card mb-4 p-3 border shadow-sm">
        <form asp-action="GuardarMota" method="post">
            <input type="hidden" name="mota.IDMota" value="@Model.Mota.IDMota" />
            <input type="hidden" name="mota.IDOrdemProducao" value="@Model.IDOrdemProducao" />

            <div class="row mb-2">
                <div class="col-md-6">
                    <label class="form-label"><strong>Cor</strong></label>
                    <input class="form-control" name="mota.Cor" value="@Model.Mota.Cor" @(Model.Estado == EstadoOrdemProducao.Concluida ? "readonly" : "") />
                </div>
                <div class="col-md-6">
                    <label class="form-label"><strong>N¬∫ Identifica√ß√£o</strong></label>
                    <input class="form-control" name="mota.NumeroIdentificacao" value="@Model.Mota.NumeroIdentificacao" @(Model.Estado == EstadoOrdemProducao.Concluida ? "readonly" : "") />
                </div>
            </div>

            <h6>üì¶ Pe√ßas com N√∫mero de S√©rie:</h6>
            <table class="table table-sm table-bordered">
                <thead class="table-light">
                    <tr>
                        <th>Pe√ßa</th>
                        <th>N√∫mero de S√©rie</th>
                    </tr>
                </thead>
                <tbody>
                    @for (int i = 0; i < Model.Mota.MotasPecasSN.Count; i++)
                    {
                        var peca = Model.Mota.MotasPecasSN.ElementAt(i);
                        <tr>
                            <td>@peca.ModeloPecasSN?.Pecas?.Descricao</td>
                            <td>
                                <input type="hidden" name="MotasPecasSN[@i].IDMotasPecasSN" value="@peca.IDMotasPecasSN" />
                                <input class="form-control form-control-sm" name="MotasPecasSN[@i].NumeroSerie" value="@peca.NumeroSerie" @(Model.Estado == EstadoOrdemProducao.Concluida ? "readonly" : "") />
                            </td>
                        </tr>
                    }
                </tbody>
            </table>

            @if (Model.Estado == EstadoOrdemProducao.EmProducao)
            {
                <button type="submit" class="btn btn-success">
                    <i class="fas fa-save me-1"></i> Guardar Mota
                </button>
            }
        </form>
    </div>
}
